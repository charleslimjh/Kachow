<!DOCTYPE html>
<html lang="en">
  <head>
    <title>BBDC Login</title>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <!-- Navbar -->
    <nav
      class="navbar navbar-dark bg-dark navbar-expand-md bg-faded justify-content-center mb-3"
    >
      <a href="/" class="navbar-brand d-flex w-50 mr-auto"
        >Bukit Batok Driving Centre</a
      >
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#collapsingNavbar3"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="navbar-collapse collapse w-100" id="collapsingNavbar3">
        <ul class="nav navbar-nav ml-auto w-100 justify-content-end">
          <li class="nav-item">
            <a class="nav-link" href="#">Login</a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row mx-auto my-2">
        <h2>Login</h2>
      </div>

      <form id="loginForm">
        <div class="form-group">
          <label for="inputEmail">Email Address</label>
          <input type="email" class="form-control" id="inputEmail" required />
        </div>
        <div class="form-group">
          <label for="inputPassword">Password</label>
          <input
            type="password"
            class="form-control"
            id="inputPassword"
            required
          />
        </div>
        <button type="button" class="btn btn-primary" id="submitData">
          Log In
        </button>
      </form>

      <div class="row mt-2 mx-auto">
        <p>
          For Testing, use this to log in:<br />
          Email:test@domain.com<br />
          Password:Password1
        </p>
      </div>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>

    <script type="module">
      // Import functions
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.2/firebase-app.js";
      import {
        getAuth,
        signInWithEmailAndPassword,
      } from "https://www.gstatic.com/firebasejs/9.8.2/firebase-auth.js";

      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyBidlQBxSNmu562K-pmgzQabDAs6CAucV4",
        authDomain: "kachow-67bdb.firebaseapp.com",
        databaseURL:
          "https://kachow-67bdb-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "kachow-67bdb",
        storageBucket: "kachow-67bdb.appspot.com",
        messagingSenderId: "544603719345",
        appId: "1:544603719345:web:0035b26a386e36b2774490",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth();

      // References
      const email = document.getElementById("inputEmail");
      const pass = document.getElementById("inputPassword");
      const submit = document.getElementById("submitData");

      // Functions
      function login(user) {
        sessionStorage.setItem("email", JSON.stringify(user));
        window.location.replace("main.html");
      }

      submit.addEventListener("click", function () {
        signInWithEmailAndPassword(auth, email.value, pass.value)
          .then((userCredential) => {
            const user = userCredential.user;
            console.log("login successful");
            login(user);
          })
          .catch((error) => {
            const errorCode = error.code;
            const errorMessage = error.message;
            console.log(error);
            alert("Invalid account credentials!")
          });
      });
    </script>
  </body>
</html>
